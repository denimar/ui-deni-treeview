"use strict";!function(){angular.module("uiDeniTreeview",[])}(),function(){function e(e){e.put("ui-deni-treeview.view.html",'<div class="ui-deni-treeview-container" ng-class="ctrl.theme">\n  <div>\n    <ui-deni-treeview-item theme="{{ctrl.theme}}" item="ctrl.rootItem" level=0 ng-if="ctrl.showRoot"></ui-deni-treeview-item>\n    <div ng-repeat="item1 in ctrl.rootItem.children">\n      <ui-deni-treeview-item theme="{{ctrl.theme}}" parent="ctrl.rootItem" item="item1" level=1></ui-deni-treeview-item>\n      <div class="ng-hide" ng-repeat="item2 in item1.children" ng-show="item1.expanded">\n        <ui-deni-treeview-item theme="{{ctrl.theme}}" parent="item1" item="item2" level=2></ui-deni-treeview-item>\n        <div class="ng-hide" ng-repeat="item3 in item2.children" ng-show="item2.expanded">\n          <ui-deni-treeview-item theme="{{ctrl.theme}}" parent="item2" item="item3" level=3></ui-deni-treeview-item>\n          <div class="ng-hide" ng-repeat="item4 in item3.children" ng-show="item3.expanded">\n            <ui-deni-treeview-item theme="{{ctrl.theme}}" parent="item3" item="item4" level=4></ui-deni-treeview-item>\n          </div>\n        </div>\n      </div>\n    </div>\n  </div>\n</div>')}angular.module("uiDeniTreeview").run(e),e.$inject=["$templateCache"]}(),function(){function e(e){e.put("ui-deni-treeview-item.view.html",'<div class="ui-deni-treeview-item-container ng-hide"  ng-show="!ctrl.item.hidden" ng-class="ctrl.getNgClassItem($parent.ctrl, ctrl)" ng-mousedown="ctrl.itemMousedown($parent.ctrl, this, ctrl.item)">\n  <div class="expand-button ng-hide" ng-click="ctrl.expandButtonClick(this, ctrl.item)" ng-class="ctrl.getNgClassExpandButton($parent.ctrl, ctrl)" ng-show="!ctrl.item.isLeaf"></div>\n  <div class="checkbox ng-hide" ng-click="ctrl.checkboxClick(this, ctrl.item)" ng-class="ctrl.getNgClassCheckbox($parent.ctrl, ctrl)" ng-show="$parent.ctrl.checkbox">\n    <div class="undetermined ng-hide" ng-show="ctrl.isUndetermined(ctrl.item)"></div>\n  </div>\n  <div class="icon-and-text" ng-class="{\'select-row\': $parent.ctrl.selectRow, \'selected\' : (!$parent.ctrl.selectRow && ctrl.isSelected($parent.ctrl, ctrl.item))}">\n    <div class="icon ng-hide" ng-class="ctrl.getNgClassIcon(ctrl, ctrl.item)" ng-dblclick="ctrl.itemDoubleClick($parent.ctrl, this, ctrl.item)" ng-show="$parent.ctrl.showIcon"></div>\n    <div class="text" ng-dblclick="ctrl.itemDoubleClick($parent.ctrl, this, ctrl.item)">\n      <span class="text-inner unselectable" ng-bind="ctrl.item.text" unselectable="on"></span>\n    </div>\n  </div\n</div>')}angular.module("uiDeniTreeview").run(e),e.$inject=["$templateCache"]}(),function(){angular.module("uiDeniTreeview").constant("uiDeniTreeviewEnum",{CHECKBOX_STATE:{CHECKED:1,UNCHECKED:2,UNDETERMINED:3}})}(),function(){angular.module("uiDeniTreeview").constant("uiDeniTreeviewConstant",{ROOT_ITEM:{id:-1,text:"root",expanded:!0,root:!0}})}(),function(){function e(){function e(e,t){return{getCheckedItems:function(){return t.getCheckedItems(e)},getSelectedItem:function(){return t.getSelectedItem(e)},load:function(n){return t.load(e,n)},loadData:function(n,i){return t.loadData(e,n,i)},reload:function(){return t.reload(e)}}}var t=this;t.implementApi=function(t,n,i){n.each(function(){angular.element(this).init.prototype.api=e(t,i)})}}angular.module("uiDeniTreeview").service("uiDeniTreeviewApiService",e)}(),function(){function e(){var e=this;e.implementEvents=function(e){e.$on("onexpand",function(t,n){t.stopPropagation(),e.$emit("onexpanditem",n)}),e.$on("oncheck",function(t,n){t.stopPropagation(),e.$emit("oncheckitem",n)}),e.$on("onload",function(e,t,n){}),e.$on("onselect",function(t,n){t.stopPropagation(),e.$emit("onselectitem",n)})}}angular.module("uiDeniTreeview").service("uiDeniTreeviewEventsService",e)}(),function(){function e(e,t,n,i,r){function c(e,t,n,i){var r=n||[];if(angular.isDefined(i)){if(!angular.isArray(r))throw new Error("When item param is set the data must be an array.");i.children=r}else angular.isArray(r)?e.rootItem.children=r:e.rootItem=angular.merge(t.ROOT_ITEM,r)}function l(e){e.children&&angular.forEach(e.children,function(t){t.state=e.state,l(t)})}var a=this;a.setDefaultValues=function(e,t,n){e.theme=e.theme||"classic",t.addClass(e.theme),e.showIcon=e.showIcon||!0,e.showRoot=e.showRoot||!1,e.selectRow=e.selectRow||!1,e.lazyLoad=e.lazyLoad||!1,e.marginItems=e.marginItems||30,e.autoLoad=e.autoLoad||!0,e.url||e.lazyLoad?e.autoLoad&&a.load(e.scope):e.items&&c(e,n,e.items)},a.load=function(n,i){var l=t.defer(),a=i||n.ctrl.rootItem,o=angular.copy(a);if(n.ctrl.url){var s={params:{lazyLoad:n.ctrl.lazyLoad,item:o}};e.get(n.ctrl.url,s).then(function(e){c(n.ctrl,r,e.data,i),l.resolve(e.data)},function(e){var t="Error loading data.";throw new Error(t)})}else if(n.ctrl.lazyLoad)!function(){delete a.children;var e=n.$watch("ctrl.rootItem",function(t,n){t!==n&&(l.resolve(a.children),e())},!0);n.$emit("onload",a)}();else{var u="To use load function you must define lazyLoad:true or a valid url.";console.error(u),l.reject(u)}return l.promise},a.loadData=function(e,t,n){c(e.ctrl,r,t,n)},a.reload=function(e){a.load(e)},a.getCheckedItems=function(e,t){var i=[],r=t||e.ctrl.items;return angular.forEach(r,function(t){if("VD"===t.type)t.state===n.CHECKBOX_STATE.CHECKED&&i.push(t.id);else if(angular.isDefined(t.state)&&t.state!==n.CHECKBOX_STATE.UNCHECKED){var r=t.children;if(!t.expanded&&t.state===n.CHECKBOX_STATE.CHECKED){var c=angular.copy(t);e.$emit("onexpanditem",c),r=c.children,l(c)}if(r){var o=a.getCheckedItems(e,r);i=i.concat(o)}}}),i},a.getSelectedItem=function(e){return e.ctrl.selectedItem}}angular.module("uiDeniTreeview").service("uiDeniTreeviewService",e),e.$inject=["$http","$q","uiDeniTreeviewEnum","uiDeniTreeviewApiService","uiDeniTreeviewConstant"]}(),function(){function e(e){function t(e,n,i){e&&angular.forEach(e,function(e){e.hidden=!n,i&&e.expanded&&t(e.children,n,i)})}function n(t){o.isChecked(t)?t.state=e.CHECKBOX_STATE.UNCHECKED:t.state=e.CHECKBOX_STATE.CHECKED}function i(e){e.children&&angular.forEach(e.children,function(t){t.state=e.state,i(t)})}function r(t){if(t&&!t.root&&angular.isDefined(t.parent)){var n=c(t),i=l(n);if(i)t.parent.state=e.CHECKBOX_STATE.CHECKED;else{var o=a(n);o?t.parent.state=e.CHECKBOX_STATE.UNCHECKED:t.parent.state=e.CHECKBOX_STATE.UNDETERMINED}r(t.parent.ctrl)}}function c(e){if(angular.isDefined(e.parent))return e.parent.children}function l(e){for(var t=0;t<e.length;t++){var n=e[t];if(!o.isChecked(n))return!1}return!0}function a(e){for(var t=0;t<e.length;t++){var n=e[t];if(!o.isUnchecked(n))return!1}return!0}var o=this;o.setDefaultValues=function(e,t){e.ctrl.item.expanded=e.ctrl.item.expanded||!1,e.ctrl.hasChild=!(!e.ctrl.item.children&&!e.$parent.ctrl.lazyLoad),e.ctrl.root=e.ctrl.item.root||!1;var n=5+e.ctrl.level*e.$parent.ctrl.marginItems;e.$parent.ctrl.showRoot||(n-=e.$parent.ctrl.marginItems),t.css("padding-left",n+"px")},o.getNgClassItem=function(e,t){var n=[t.theme];return e.selectRow&&(n.push("select-row"),t.isSelected(e,t.item)&&n.push("selected")),n},o.getNgClassExpandButton=function(e,t){var n=[];return t.hasChild&&n.push("hasChild"),t.item.expanded?n.push("expanded"):n.push("colapsed"),t.loading&&n.push("loading"),t.isSelected(e,t.item)&&n.push("selected"),n},o.getNgClassCheckbox=function(e,t){var n=[];return t.isChecked(t.item)&&n.push("checked"),t.isSelected(e,t.item)&&n.push("selected"),n},o.getNgClassIcon=function(e,t){var n=[];return t.isLeaf&&n.push("isleaf"),t.expanded&&n.push("expanded"),n},o.expandButtonClick=function(e,n){var i=!n.expanded;i?!function(){e.ctrl.loading=!0;var r=function(){n.children&&(n.expanded=i,t(n.children,!0,!0)),e.ctrl.loading=!1};e.$parent.ctrl.lazyLoad?angular.isDefined(n.children)?r():e.$parent.ctrl.element.api.load(n).then(function(e){r()}):r()}():(n.expanded=i,t(n.children,!1,!0))},o.checkboxClick=function(e,t){n(t),i(t),r(e.ctrl),e.$emit("oncheck",t)},o.itemMousedown=function(e,t,n){var i=angular.element(event.target),r=function(){e.selectedItem=n,t.$emit("onselect",n)};e.selectRow?r():(i.is(".icon")||i.is(".text-inner")||i.is(".text"))&&r()},o.itemDoubleClick=function(e,t,n){o.expandButtonClick(t,n)},o.isSelected=function(e,t){return angular.equals(e.selectedItem,t)},o.isChecked=function(t){return t.state===e.CHECKBOX_STATE.CHECKED},o.isUnchecked=function(t){return t.state===e.CHECKBOX_STATE.UNCHECKED},o.isUndetermined=function(t){return t.state===e.CHECKBOX_STATE.UNDETERMINED}}angular.module("uiDeniTreeview").service("uiDeniTreeviewItemService",e),e.$inject=["uiDeniTreeviewEnum"]}(),function(){function e(e,t,n){this.scope=e,this.rootItem=n.ROOT_ITEM}angular.module("uiDeniTreeview").controller("uiDeniTreeviewController",e),e.$inject=["$scope","uiDeniTreeviewService","uiDeniTreeviewConstant"]}(),function(){function e(e){this.getNgClassItem=e.getNgClassItem,this.getNgClassExpandButton=e.getNgClassExpandButton,this.getNgClassCheckbox=e.getNgClassCheckbox,this.getNgClassIcon=e.getNgClassIcon,this.expandButtonClick=e.expandButtonClick,this.checkboxClick=e.checkboxClick,this.itemMousedown=e.itemMousedown,this.itemDoubleClick=e.itemDoubleClick,this.isSelected=e.isSelected,this.isChecked=e.isChecked,this.isUndetermined=e.isUndetermined}angular.module("uiDeniTreeview").controller("uiDeniTreeviewItemController",e),e.$inject=["uiDeniTreeviewItemService"]}(),function(){function e(e,t,n,i,r){return{restrict:"E",scope:{},bindToController:{url:"=?",autoLoad:"=?",checkbox:"=?",items:"=?",lazyLoad:"=?",selectRow:"=?",showIcon:"=?",showRoot:"=?",theme:"=?"},controller:"uiDeniTreeviewController",controllerAs:"ctrl",replace:!0,template:e.get("ui-deni-treeview.view.html"),link:function(e,c,l){e.ctrl.element=angular.element(c),n.setDefaultValues(e.ctrl,c,t),r.implementApi(e,e.ctrl.element,n),i.implementEvents(e)}}}angular.module("uiDeniTreeview").directive("uiDeniTreeview",e),e.$inject=["$templateCache","uiDeniTreeviewConstant","uiDeniTreeviewService","uiDeniTreeviewEventsService","uiDeniTreeviewApiService"]}(),function(){function e(e,t){return{restrict:"E",scope:{},bindToController:{item:"=",level:"=",parent:"=?",theme:"@?"},controller:"uiDeniTreeviewItemController",controllerAs:"ctrl",replace:!0,template:e.get("ui-deni-treeview-item.view.html"),link:function(e,n,i){t.setDefaultValues(e,n),e.$watch("ctrl.item.expanded",function(t,n){t!==n&&e.$emit("onexpand",e.ctrl.item)})}}}angular.module("uiDeniTreeview").directive("uiDeniTreeviewItem",e),e.$inject=["$templateCache","uiDeniTreeviewItemService"]}();